<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZED CMS Admin Dashboard</title>
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #3a86ff;
            --primary-dark: #2667cc;
            --secondary: #8338ec;
            --success: #38b000;
            --danger: #ff006e;
            --warning: #ffbe0b;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --light-gray: #e9ecef;
            --border: #dee2e6;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background-color: #f5f7fa;
            color: var(--dark);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header & Navigation */
        header {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 1.5rem;
        }

        nav a {
            text-decoration: none;
            color: var(--dark);
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: background 0.3s;
        }

        nav a:hover, nav a.active {
            background: var(--light-gray);
            color: var(--primary);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logout-btn {
            background: var(--danger);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .logout-btn:hover {
            background: #cc0058;
        }

        /* Main Content */
        main {
            padding: 2rem 0;
        }

        .page-title {
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            color: var(--dark);
        }

        /* Login Page */
        .login-container {
            max-width: 400px;
            margin: 5rem auto;
            padding: 2rem;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .login-container h2 {
            text-align: center;
            margin-bottom: 1.5rem;
            color: var(--primary);
        }

        .form-group {
            margin-bottom: 1.2rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: 4px;
            font-size: 1rem;
            transition: border 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(58, 134, 255, 0.1);
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            cursor: pointer;
            transition: background 0.3s;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            width: 100%;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-secondary {
            background: var(--secondary);
            color: white;
        }

        .btn-secondary:hover {
            background: #6a2bc0;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: #cc0058;
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #2d9500;
        }

        .btn-small {
            padding: 0.4rem 0.8rem;
            font-size: 0.875rem;
        }

        /* Alerts */
        .alert {
            padding: 1rem;
            border-radius: 4px;
            margin-bottom: 1.5rem;
            display: none;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .alert-warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        /* Posts Table */
        .card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            overflow: hidden;
        }

        .card-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-body {
            padding: 1.5rem;
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background: var(--light);
            font-weight: 600;
            text-align: left;
            padding: 1rem;
            border-bottom: 2px solid var(--border);
        }

        td {
            padding: 1rem;
            border-bottom: 1px solid var(--border);
        }

        tr:hover {
            background: var(--light-gray);
        }

        .status-badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .status-published {
            background: #d4edda;
            color: #155724;
        }

        .status-draft {
            background: #fff3cd;
            color: #856404;
        }

        .status-scheduled {
            background: #cce5ff;
            color: #004085;
        }

        .action-buttons {
            display: flex;
            gap: 0.5rem;
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border);
            margin-bottom: 1.5rem;
        }

        .tab {
            padding: 0.75rem 1.5rem;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            color: var(--gray);
            position: relative;
        }

        .tab:hover {
            color: var(--dark);
        }

        .tab.active {
            color: var(--primary);
            font-weight: 600;
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Forms */
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border);
        }

        .file-upload {
            border: 2px dashed var(--border);
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: border 0.3s;
        }

        .file-upload:hover {
            border-color: var(--primary);
        }

        .file-upload input[type="file"] {
            display: none;
        }

        .file-preview {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .preview-item {
            width: 150px;
            height: 150px;
            border-radius: 4px;
            overflow: hidden;
            position: relative;
            border: 1px solid var(--border);
        }

        .preview-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .preview-item audio {
            width: 100%;
            margin-top: 40px;
        }

        .remove-file {
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--danger);
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            border-radius: 8px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            padding: 1.5rem;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
        }

        /* Confirmation Dialog */
        .confirmation-dialog {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .dialog-content {
            background: white;
            border-radius: 8px;
            padding: 2rem;
            max-width: 400px;
            text-align: center;
        }

        .dialog-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 1.5rem;
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 1.5rem;
        }

        .page-btn {
            padding: 0.5rem 0.75rem;
            border: 1px solid var(--border);
            background: white;
            border-radius: 4px;
            cursor: pointer;
        }

        .page-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .page-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Loading Spinner */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid var(--light-gray);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
            }

            nav ul {
                flex-wrap: wrap;
                justify-content: center;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div id="login-page" class="login-container">
        <h2>ZED CMS Admin Login</h2>
        <div id="login-alert" class="alert alert-error" style="display: none;"></div>
        <form id="login-form">
            <div class="form-group">
                <label for="username">Username</label>
                <input type="text" id="username" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" class="form-control" required>
            </div>
            <button type="submit" class="btn btn-primary" id="login-btn">Login</button>
        </form>
    </div>

    <!-- Dashboard (Hidden by default) -->
    <div id="dashboard" style="display: none;">
        <header>
            <div class="container">
                <div class="header-content">
                    <div class="logo">ZED CMS Admin</div>
                    <nav>
                        <ul>
                            <li><a href="#" class="nav-link active" data-page="posts">Posts</a></li>
                            <li><a href="#" class="nav-link" data-page="create">Create Post</a></li>
                            <li><a href="#" class="nav-link" data-page="drafts">Drafts & Scheduled</a></li>
                            <li><a href="#" class="nav-link" data-page="taxonomies">Taxonomies</a></li>
                        </ul>
                    </nav>
                    <div class="user-info">
                        <span id="username-display"></span>
                        <button class="logout-btn" id="logout-btn">Logout</button>
                    </div>
                </div>
            </div>
        </header>

        <main>
            <div class="container">
                <!-- Alerts -->
                <div id="alert-container"></div>

                <!-- Posts Page -->
                <div id="posts-page" class="page-content active">
                    <h1 class="page-title">Posts Management</h1>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2>All Posts</h2>
                            <div>
                                <button class="btn btn-secondary btn-small" id="refresh-posts">Refresh</button>
                                <button class="btn btn-danger btn-small" id="bulk-delete-btn" style="display: none;">Delete Selected</button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-container">
                                <table id="posts-table">
                                    <thead>
                                        <tr>
                                            <th style="width: 30px;"><input type="checkbox" id="select-all"></th>
                                            <th>Title</th>
                                            <th>Artist</th>
                                            <th>Category</th>
                                            <th>Status</th>
                                            <th>Views</th>
                                            <th>Created</th>
                                            <th>Updated</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="posts-table-body">
                                        <!-- Posts will be loaded here -->
                                    </tbody>
                                </table>
                            </div>
                            <div class="pagination" id="pagination">
                                <!-- Pagination will be generated here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Create Post Page -->
                <div id="create-page" class="page-content">
                    <h1 class="page-title">Create New Post</h1>
                    <div class="card">
                        <div class="card-body">
                            <form id="create-post-form">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="title">Title *</label>
                                        <input type="text" id="title" class="form-control" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="artist">Artist *</label>
                                        <input type="text" id="artist" class="form-control" required>
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="category">Category</label>
                                        <input type="text" id="category" class="form-control">
                                    </div>
                                    <div class="form-group">
                                        <label for="tags">Tags (comma separated)</label>
                                        <input type="text" id="tags" class="form-control" placeholder="tag1, tag2, tag3">
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="description">Description</label>
                                    <textarea id="description" class="form-control" rows="3"></textarea>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="status">Status</label>
                                        <select id="status" class="form-control">
                                            <option value="draft">Draft</option>
                                            <option value="published">Published</option>
                                            <option value="scheduled">Scheduled</option>
                                        </select>
                                    </div>
                                    <div class="form-group" id="scheduled-field" style="display: none;">
                                        <label for="scheduled_at">Scheduled Date & Time</label>
                                        <input type="datetime-local" id="scheduled_at" class="form-control">
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Audio File (MP3)</label>
                                        <div class="file-upload" id="audio-upload">
                                            <span>Click to upload audio file (.mp3)</span>
                                            <input type="file" id="audio" accept=".mp3,audio/mpeg">
                                        </div>
                                        <div class="file-preview" id="audio-preview"></div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label>Image File (JPG/PNG)</label>
                                        <div class="file-upload" id="image-upload">
                                            <span>Click to upload image file (.jpg, .png)</span>
                                            <input type="file" id="image" accept=".jpg,.jpeg,.png,image/jpeg,image/png">
                                        </div>
                                        <div class="file-preview" id="image-preview"></div>
                                    </div>
                                </div>
                                
                                <div class="form-actions">
                                    <button type="submit" class="btn btn-primary" id="create-post-btn">Create Post</button>
                                    <button type="reset" class="btn btn-secondary">Reset</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Drafts & Scheduled Page -->
                <div id="drafts-page" class="page-content">
                    <h1 class="page-title">Drafts & Scheduled Posts</h1>
                    
                    <div class="tabs">
                        <button class="tab active" data-tab="drafts-tab">Drafts</button>
                        <button class="tab" data-tab="scheduled-tab">Scheduled</button>
                    </div>
                    
                    <div id="drafts-tab" class="tab-content active">
                        <div class="card">
                            <div class="card-body">
                                <table id="drafts-table">
                                    <thead>
                                        <tr>
                                            <th>Title</th>
                                            <th>Artist</th>
                                            <th>Created</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="drafts-table-body">
                                        <!-- Drafts will be loaded here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <div id="scheduled-tab" class="tab-content">
                        <div class="card">
                            <div class="card-body">
                                <table id="scheduled-table">
                                    <thead>
                                        <tr>
                                            <th>Title</th>
                                            <th>Artist</th>
                                            <th>Scheduled For</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="scheduled-table-body">
                                        <!-- Scheduled posts will be loaded here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Taxonomies Page -->
                <div id="taxonomies-page" class="page-content">
                    <h1 class="page-title">Taxonomies</h1>
                    
                    <div class="tabs">
                        <button class="tab active" data-tab="artists-tab">Artists</button>
                        <button class="tab" data-tab="tags-tab">Tags</button>
                        <button class="tab" data-tab="categories-tab">Categories</button>
                    </div>
                    
                    <div id="artists-tab" class="tab-content active">
                        <div class="card">
                            <div class="card-body">
                                <div id="artists-list">
                                    <!-- Artists will be loaded here -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="tags-tab" class="tab-content">
                        <div class="card">
                            <div class="card-body">
                                <div id="tags-list">
                                    <!-- Tags will be loaded here -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="categories-tab" class="tab-content">
                        <div class="card">
                            <div class="card-body">
                                <div id="categories-list">
                                    <!-- Categories will be loaded here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Edit Post Modal -->
    <div id="edit-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Post</h3>
                <button class="close-modal" id="close-edit-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="edit-post-form">
                    <input type="hidden" id="edit-post-id">
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="edit-title">Title *</label>
                            <input type="text" id="edit-title" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="edit-artist">Artist *</label>
                            <input type="text" id="edit-artist" class="form-control" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="edit-category">Category</label>
                            <input type="text" id="edit-category" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="edit-tags">Tags (comma separated)</label>
                            <input type="text" id="edit-tags" class="form-control">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-description">Description</label>
                        <textarea id="edit-description" class="form-control" rows="3"></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="edit-status">Status</label>
                            <select id="edit-status" class="form-control">
                                <option value="draft">Draft</option>
                                <option value="published">Published</option>
                                <option value="scheduled">Scheduled</option>
                            </select>
                        </div>
                        <div class="form-group" id="edit-scheduled-field" style="display: none;">
                            <label for="edit-scheduled_at">Scheduled Date & Time</label>
                            <input type="datetime-local" id="edit-scheduled_at" class="form-control">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Replace Audio File (MP3)</label>
                            <div class="file-upload" id="edit-audio-upload">
                                <span>Click to upload new audio file</span>
                                <input type="file" id="edit-audio" accept=".mp3,audio/mpeg">
                            </div>
                            <div class="file-preview" id="edit-audio-preview"></div>
                        </div>
                        
                        <div class="form-group">
                            <label>Replace Image File (JPG/PNG)</label>
                            <div class="file-upload" id="edit-image-upload">
                                <span>Click to upload new image file</span>
                                <input type="file" id="edit-image" accept=".jpg,.jpeg,.png,image/jpeg,image/png">
                            </div>
                            <div class="file-preview" id="edit-image-preview"></div>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary" id="save-edit-btn">Save Changes</button>
                        <button type="button" class="btn btn-secondary" id="cancel-edit-btn">Cancel</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Confirmation Dialog -->
    <div id="confirmation-dialog" class="confirmation-dialog">
        <div class="dialog-content">
            <h3 id="confirmation-title">Confirm Action</h3>
            <p id="confirmation-message">Are you sure you want to perform this action?</p>
            <div class="dialog-actions">
                <button class="btn btn-danger" id="confirm-btn">Confirm</button>
                <button class="btn btn-secondary" id="cancel-btn">Cancel</button>
            </div>
        </div>
    </div>

    <script>
        // Configuration
        const API_BASE_URL = 'https://cms.zedtopvibes.workers.dev'; // Set your Worker URL here, e.g., 'https://your-worker.workers.dev'
        const TOKEN_KEY = 'zed_cms_token';
        const USERNAME_KEY = 'zed_cms_username';

        // State management
        let state = {
            token: localStorage.getItem(TOKEN_KEY) || null,
            username: localStorage.getItem(USERNAME_KEY) || null,
            currentPage: 'posts',
            posts: [],
            currentPosts: [],
            pagination: {
                currentPage: 1,
                totalPages: 1,
                pageSize: 10
            },
            selectedPosts: new Set(),
            drafts: [],
            scheduled: [],
            artists: [],
            tags: [],
            categories: [],
            editPostId: null,
            confirmationCallback: null
        };

        // DOM Elements
        const elements = {
            // Pages
            loginPage: document.getElementById('login-page'),
            dashboard: document.getElementById('dashboard'),
            
            // Login
            loginForm: document.getElementById('login-form'),
            loginAlert: document.getElementById('login-alert'),
            loginBtn: document.getElementById('login-btn'),
            
            // Dashboard
            logoutBtn: document.getElementById('logout-btn'),
            usernameDisplay: document.getElementById('username-display'),
            navLinks: document.querySelectorAll('.nav-link'),
            pageContents: document.querySelectorAll('.page-content'),
            
            // Posts
            postsTableBody: document.getElementById('posts-table-body'),
            pagination: document.getElementById('pagination'),
            selectAll: document.getElementById('select-all'),
            bulkDeleteBtn: document.getElementById('bulk-delete-btn'),
            refreshPosts: document.getElementById('refresh-posts'),
            
            // Create Post
            createPostForm: document.getElementById('create-post-form'),
            createPostBtn: document.getElementById('create-post-btn'),
            statusSelect: document.getElementById('status'),
            scheduledField: document.getElementById('scheduled-field'),
            scheduledAt: document.getElementById('scheduled_at'),
            audioUpload: document.getElementById('audio-upload'),
            audioInput: document.getElementById('audio'),
            audioPreview: document.getElementById('audio-preview'),
            imageUpload: document.getElementById('image-upload'),
            imageInput: document.getElementById('image'),
            imagePreview: document.getElementById('image-preview'),
            
            // Drafts & Scheduled
            tabs: document.querySelectorAll('.tab'),
            tabContents: document.querySelectorAll('.tab-content'),
            draftsTableBody: document.getElementById('drafts-table-body'),
            scheduledTableBody: document.getElementById('scheduled-table-body'),
            
            // Taxonomies
            artistsList: document.getElementById('artists-list'),
            tagsList: document.getElementById('tags-list'),
            categoriesList: document.getElementById('categories-list'),
            
            // Edit Modal
            editModal: document.getElementById('edit-modal'),
            editPostForm: document.getElementById('edit-post-form'),
            editPostId: document.getElementById('edit-post-id'),
            editTitle: document.getElementById('edit-title'),
            editArtist: document.getElementById('edit-artist'),
            editCategory: document.getElementById('edit-category'),
            editTags: document.getElementById('edit-tags'),
            editDescription: document.getElementById('edit-description'),
            editStatus: document.getElementById('edit-status'),
            editScheduledField: document.getElementById('edit-scheduled-field'),
            editScheduledAt: document.getElementById('edit-scheduled_at'),
            editAudioUpload: document.getElementById('edit-audio-upload'),
            editAudioInput: document.getElementById('edit-audio'),
            editAudioPreview: document.getElementById('edit-audio-preview'),
            editImageUpload: document.getElementById('edit-image-upload'),
            editImageInput: document.getElementById('edit-image'),
            editImagePreview: document.getElementById('edit-image-preview'),
            closeEditModal: document.getElementById('close-edit-modal'),
            cancelEditBtn: document.getElementById('cancel-edit-btn'),
            saveEditBtn: document.getElementById('save-edit-btn'),
            
            // Confirmation Dialog
            confirmationDialog: document.getElementById('confirmation-dialog'),
            confirmationTitle: document.getElementById('confirmation-title'),
            confirmationMessage: document.getElementById('confirmation-message'),
            confirmBtn: document.getElementById('confirm-btn'),
            cancelBtn: document.getElementById('cancel-btn'),
            
            // Alerts
            alertContainer: document.getElementById('alert-container')
        };

        // Initialize the application
        function init() {
            // Check if user is already logged in
            if (state.token && state.username) {
                showDashboard();
            } else {
                showLogin();
            }
            
            // Setup event listeners
            setupEventListeners();
        }

        // Setup all event listeners
        function setupEventListeners() {
            // Login
            elements.loginForm.addEventListener('submit', handleLogin);
            
            // Logout
            elements.logoutBtn.addEventListener('click', handleLogout);
            
            // Navigation
            elements.navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    navigateTo(link.dataset.page);
                });
            });
            
            // Posts
            elements.selectAll.addEventListener('change', toggleSelectAll);
            elements.bulkDeleteBtn.addEventListener('click', confirmBulkDelete);
            elements.refreshPosts.addEventListener('click', loadPosts);
            
            // Create Post
            elements.createPostForm.addEventListener('submit', handleCreatePost);
            elements.statusSelect.addEventListener('change', toggleScheduledField);
            
            // File Uploads
            elements.audioUpload.addEventListener('click', () => elements.audioInput.click());
            elements.audioInput.addEventListener('change', handleAudioUpload);
            elements.imageUpload.addEventListener('click', () => elements.imageInput.click());
            elements.imageInput.addEventListener('change', handleImageUpload);
            
            // Edit Post
            elements.editAudioUpload.addEventListener('click', () => elements.editAudioInput.click());
            elements.editAudioInput.addEventListener('change', handleEditAudioUpload);
            elements.editImageUpload.addEventListener('click', () => elements.editImageInput.click());
            elements.editImageInput.addEventListener('change', handleEditImageUpload);
            elements.editStatus.addEventListener('change', toggleEditScheduledField);
            elements.closeEditModal.addEventListener('click', closeEditModal);
            elements.cancelEditBtn.addEventListener('click', closeEditModal);
            elements.editPostForm.addEventListener('submit', handleEditPost);
            
            // Tabs
            elements.tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.dataset.tab;
                    switchTab(tabId);
                });
            });
            
            // Confirmation Dialog
            elements.confirmBtn.addEventListener('click', executeConfirmation);
            elements.cancelBtn.addEventListener('click', closeConfirmationDialog);
        }

        // Authentication functions
        async function handleLogin(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            // Show loading state
            elements.loginBtn.innerHTML = '<span class="loading"></span> Logging in...';
            elements.loginBtn.disabled = true;
            
            try {
                const response = await fetch(`${API_BASE_URL}/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ username, password })
                });
                
                if (!response.ok) {
                    throw new Error('Login failed');
                }
                
                const data = await response.json();
                
                // Store token and username
                state.token = data.token;
                state.username = username;
                localStorage.setItem(TOKEN_KEY, data.token);
                localStorage.setItem(USERNAME_KEY, username);
                
                // Show dashboard
                showDashboard();
                showAlert('Login successful!', 'success');
                
            } catch (error) {
                showLoginAlert('Invalid username or password');
            } finally {
                // Reset login button
                elements.loginBtn.innerHTML = 'Login';
                elements.loginBtn.disabled = false;
            }
        }

        function handleLogout() {
            state.token = null;
            state.username = null;
            localStorage.removeItem(TOKEN_KEY);
            localStorage.removeItem(USERNAME_KEY);
            showLogin();
        }

        // Navigation functions
        function showLogin() {
            elements.loginPage.style.display = 'block';
            elements.dashboard.style.display = 'none';
            elements.loginForm.reset();
            elements.loginAlert.style.display = 'none';
        }

        function showDashboard() {
            elements.loginPage.style.display = 'none';
            elements.dashboard.style.display = 'block';
            elements.usernameDisplay.textContent = state.username;
            
            // Load initial data
            loadPosts();
            navigateTo('posts');
        }

        function navigateTo(page) {
            // Update navigation
            elements.navLinks.forEach(link => {
                link.classList.toggle('active', link.dataset.page === page);
            });
            
            // Show the selected page
            elements.pageContents.forEach(content => {
                content.classList.toggle('active', content.id === `${page}-page`);
            });
            
            // Load page-specific data
            switch(page) {
                case 'posts':
                    loadPosts();
                    break;
                case 'drafts':
                    loadDrafts();
                    break;
                case 'taxonomies':
                    loadTaxonomies();
                    break;
            }
            
            state.currentPage = page;
        }

        // API functions
        async function apiRequest(endpoint, options = {}) {
            const defaultOptions = {
                headers: {
                    'Authorization': `Bearer ${state.token}`
                }
            };
            
            const mergedOptions = {
                ...defaultOptions,
                ...options,
                headers: {
                    ...defaultOptions.headers,
                    ...options.headers
                }
            };
            
            const response = await fetch(`${API_BASE_URL}${endpoint}`, mergedOptions);
            
            if (response.status === 401) {
                // Token expired or invalid
                handleLogout();
                throw new Error('Session expired. Please login again.');
            }
            
            if (!response.ok) {
                const error = await response.json().catch(() => ({}));
                throw new Error(error.message || 'API request failed');
            }
            
            return response.json();
        }

        // Posts management
        async function loadPosts(page = 1) {
            try {
                const data = await apiRequest(`/posts?page=${page}&limit=${state.pagination.pageSize}`);
                state.posts = data.posts;
                state.currentPosts = data.posts;
                state.pagination.currentPage = data.pagination.page;
                state.pagination.totalPages = data.pagination.pages;
                
                renderPostsTable();
                renderPagination();
            } catch (error) {
                showAlert(`Failed to load posts: ${error.message}`, 'error');
            }
        }

        function renderPostsTable() {
            elements.postsTableBody.innerHTML = '';
            
            if (state.currentPosts.length === 0) {
                elements.postsTableBody.innerHTML = `
                    <tr>
                        <td colspan="9" style="text-align: center; padding: 2rem;">
                            No posts found
                        </td>
                    </tr>
                `;
                return;
            }
            
            state.currentPosts.forEach(post => {
                const row = document.createElement('tr');
                row.dataset.id = post.id;
                
                // Format dates
                const createdDate = new Date(post.created_at).toLocaleDateString();
                const updatedDate = new Date(post.updated_at).toLocaleDateString();
                
                // Status badge
                let statusBadge = '';
                switch(post.status) {
                    case 'published':
                        statusBadge = '<span class="status-badge status-published">Published</span>';
                        break;
                    case 'draft':
                        statusBadge = '<span class="status-badge status-draft">Draft</span>';
                        break;
                    case 'scheduled':
                        statusBadge = '<span class="status-badge status-scheduled">Scheduled</span>';
                        break;
                }
                
                row.innerHTML = `
                    <td><input type="checkbox" class="post-checkbox" value="${post.id}"></td>
                    <td>${post.title}</td>
                    <td>${post.artist}</td>
                    <td>${post.category || '-'}</td>
                    <td>${statusBadge}</td>
                    <td>${post.views || 0}</td>
                    <td>${createdDate}</td>
                    <td>${updatedDate}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn btn-secondary btn-small edit-post-btn" data-id="${post.id}">Edit</button>
                            <button class="btn btn-danger btn-small delete-post-btn" data-slug="${post.slug}">Delete</button>
                        </div>
                    </td>
                `;
                
                elements.postsTableBody.appendChild(row);
            });
            
            // Add event listeners to buttons
            document.querySelectorAll('.edit-post-btn').forEach(btn => {
                btn.addEventListener('click', () => openEditModal(btn.dataset.id));
            });
            
            document.querySelectorAll('.delete-post-btn').forEach(btn => {
                btn.addEventListener('click', () => confirmDeletePost(btn.dataset.slug));
            });
            
            document.querySelectorAll('.post-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', togglePostSelection);
            });
            
            // Update bulk delete button visibility
            updateBulkDeleteButton();
        }

        function renderPagination() {
            elements.pagination.innerHTML = '';
            
            const { currentPage, totalPages } = state.pagination;
            
            // Previous button
            const prevBtn = document.createElement('button');
            prevBtn.className = 'page-btn';
            prevBtn.textContent = '←';
            prevBtn.disabled = currentPage === 1;
            prevBtn.addEventListener('click', () => loadPosts(currentPage - 1));
            elements.pagination.appendChild(prevBtn);
            
            // Page numbers
            for (let i = 1; i <= totalPages; i++) {
                const pageBtn = document.createElement('button');
                pageBtn.className = `page-btn ${i === currentPage ? 'active' : ''}`;
                pageBtn.textContent = i;
                pageBtn.addEventListener('click', () => loadPosts(i));
                elements.pagination.appendChild(pageBtn);
            }
            
            // Next button
            const nextBtn = document.createElement('button');
            nextBtn.className = 'page-btn';
            nextBtn.textContent = '→';
            nextBtn.disabled = currentPage === totalPages;
            nextBtn.addEventListener('click', () => loadPosts(currentPage + 1));
            elements.pagination.appendChild(nextBtn);
        }

        // Create post functions
        async function handleCreatePost(e) {
            e.preventDefault();
            
            const formData = new FormData();
            
            // Add text fields
            formData.append('title', document.getElementById('title').value);
            formData.append('artist', document.getElementById('artist').value);
            formData.append('category', document.getElementById('category').value);
            formData.append('tags', document.getElementById('tags').value);
            formData.append('description', document.getElementById('description').value);
            formData.append('status', document.getElementById('status').value);
            
            if (document.getElementById('status').value === 'scheduled') {
                formData.append('scheduled_at', document.getElementById('scheduled_at').value);
            }
            
            // Add files
            const audioFile = elements.audioInput.files[0];
            const imageFile = elements.imageInput.files[0];
            
            if (audioFile) formData.append('audio', audioFile);
            if (imageFile) formData.append('image', imageFile);
            
            // Show loading state
            elements.createPostBtn.innerHTML = '<span class="loading"></span> Creating...';
            elements.createPostBtn.disabled = true;
            
            try {
                await apiRequest('/posts', {
                    method: 'POST',
                    body: formData
                });
                
                showAlert('Post created successfully!', 'success');
                elements.createPostForm.reset();
                clearFilePreviews();
                
                // Navigate to posts page
                navigateTo('posts');
                
            } catch (error) {
                showAlert(`Failed to create post: ${error.message}`, 'error');
            } finally {
                elements.createPostBtn.innerHTML = 'Create Post';
                elements.createPostBtn.disabled = false;
            }
        }

        // Drafts & Scheduled functions
        async function loadDrafts() {
            try {
                const data = await apiRequest('/drafts');
                state.drafts = data.drafts;
                state.scheduled = data.scheduled;
                
                renderDraftsTable();
                renderScheduledTable();
            } catch (error) {
                showAlert(`Failed to load drafts: ${error.message}`, 'error');
            }
        }

        function renderDraftsTable() {
            elements.draftsTableBody.innerHTML = '';
            
            if (state.drafts.length === 0) {
                elements.draftsTableBody.innerHTML = `
                    <tr>
                        <td colspan="4" style="text-align: center; padding: 2rem;">
                            No drafts found
                        </td>
                    </tr>
                `;
                return;
            }
            
            state.drafts.forEach(draft => {
                const createdDate = new Date(draft.created_at).toLocaleDateString();
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${draft.title}</td>
                    <td>${draft.artist}</td>
                    <td>${createdDate}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn btn-secondary btn-small edit-post-btn" data-id="${draft.id}">Edit</button>
                            <button class="btn btn-success btn-small publish-draft-btn" data-id="${draft.id}">Publish</button>
                            <button class="btn btn-danger btn-small delete-post-btn" data-slug="${draft.slug}">Delete</button>
                        </div>
                    </td>
                `;
                
                elements.draftsTableBody.appendChild(row);
            });
            
            // Add event listeners
            document.querySelectorAll('.publish-draft-btn').forEach(btn => {
                btn.addEventListener('click', () => publishDraft(btn.dataset.id));
            });
        }

        function renderScheduledTable() {
            elements.scheduledTableBody.innerHTML = '';
            
            if (state.scheduled.length === 0) {
                elements.scheduledTableBody.innerHTML = `
                    <tr>
                        <td colspan="4" style="text-align: center; padding: 2rem;">
                            No scheduled posts found
                        </td>
                    </tr>
                `;
                return;
            }
            
            state.scheduled.forEach(post => {
                const scheduledDate = new Date(post.scheduled_at).toLocaleString();
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${post.title}</td>
                    <td>${post.artist}</td>
                    <td>${scheduledDate}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn btn-secondary btn-small edit-post-btn" data-id="${post.id}">Edit</button>
                            <button class="btn btn-success btn-small publish-now-btn" data-id="${post.id}">Publish Now</button>
                            <button class="btn btn-danger btn-small delete-post-btn" data-slug="${post.slug}">Delete</button>
                        </div>
                    </td>
                `;
                
                elements.scheduledTableBody.appendChild(row);
            });
        }

        async function publishDraft(postId) {
            try {
                // Find the draft
                const draft = state.drafts.find(d => d.id === postId);
                if (!draft) return;
                
                // Update status to published
                const formData = new FormData();
                formData.append('status', 'published');
                
                await apiRequest(`/posts/${draft.slug}`, {
                    method: 'PUT',
                    body: formData
                });
                
                showAlert('Draft published successfully!', 'success');
                loadDrafts();
                loadPosts();
                
            } catch (error) {
                showAlert(`Failed to publish draft: ${error.message}`, 'error');
            }
        }

        // Taxonomies functions
        async function loadTaxonomies() {
            try {
                // Load artists from posts
                const postsData = await apiRequest('/posts?limit=100');
                const uniqueArtists = [...new Set(postsData.posts.map(p => p.artist))];
                state.artists = uniqueArtists.sort();
                
                // Load tags
                const tagsData = await apiRequest('/tags');
                state.tags = tagsData.tags;
                
                // Load categories
                const categoriesData = await apiRequest('/categories');
                state.categories = categoriesData.categories;
                
                renderTaxonomies();
            } catch (error) {
                showAlert(`Failed to load taxonomies: ${error.message}`, 'error');
            }
        }

        function renderTaxonomies() {
            // Render artists
            elements.artistsList.innerHTML = '';
            if (state.artists.length === 0) {
                elements.artistsList.innerHTML = '<p>No artists found</p>';
            } else {
                const artistsHTML = state.artists.map(artist => `
                    <div style="padding: 0.5rem; border-bottom: 1px solid var(--border);">
                        <strong>${artist}</strong>
                        <button class="btn btn-secondary btn-small" style="float: right;" 
                                onclick="viewArtistPosts('${artist}')">
                            View Posts
                        </button>
                    </div>
                `).join('');
                elements.artistsList.innerHTML = artistsHTML;
            }
            
            // Render tags
            elements.tagsList.innerHTML = '';
            if (state.tags.length === 0) {
                elements.tagsList.innerHTML = '<p>No tags found</p>';
            } else {
                const tagsHTML = state.tags.map(tag => `
                    <span class="status-badge" style="margin: 0.25rem; background: var(--light); color: var(--dark);">
                        ${tag}
                    </span>
                `).join('');
                elements.tagsList.innerHTML = tagsHTML;
            }
            
            // Render categories
            elements.categoriesList.innerHTML = '';
            if (state.categories.length === 0) {
                elements.categoriesList.innerHTML = '<p>No categories found</p>';
            } else {
                const categoriesHTML = state.categories.map(category => `
                    <div style="padding: 0.5rem; border-bottom: 1px solid var(--border);">
                        ${category}
                    </div>
                `).join('');
                elements.categoriesList.innerHTML = categoriesHTML;
            }
        }

        // Edit post functions
        async function openEditModal(postId) {
            try {
                // Find the post
                const post = state.posts.find(p => p.id === postId) ||
                             state.drafts.find(p => p.id === postId) ||
                             state.scheduled.find(p => p.id === postId);
                
                if (!post) return;
                
                state.editPostId = postId;
                
                // Populate form fields
                elements.editPostId.value = post.id;
                elements.editTitle.value = post.title;
                elements.editArtist.value = post.artist;
                elements.editCategory.value = post.category || '';
                elements.editTags.value = post.tags?.join(', ') || '';
                elements.editDescription.value = post.description || '';
                elements.editStatus.value = post.status;
                
                // Clear file previews
                elements.editAudioPreview.innerHTML = '';
                elements.editImagePreview.innerHTML = '';
                
                // Show existing media if available
                if (post.audio_url) {
                    elements.editAudioPreview.innerHTML = `
                        <div class="preview-item">
                            <audio controls>
                                <source src="${post.audio_url}" type="audio/mpeg">
                            </audio>
                            <small style="position: absolute; top: 5px; left: 5px; background: rgba(0,0,0,0.7); color: white; padding: 2px 5px; border-radius: 3px;">
                                Current
                            </small>
                        </div>
                    `;
                }
                
                if (post.image_url) {
                    elements.editImagePreview.innerHTML = `
                        <div class="preview-item">
                            <img src="${post.image_url}" alt="Current image">
                            <small style="position: absolute; top: 5px; left: 5px; background: rgba(0,0,0,0.7); color: white; padding: 2px 5px; border-radius: 3px;">
                                Current
                            </small>
                        </div>
                    `;
                }
                
                // Show modal
                elements.editModal.style.display = 'flex';
                
            } catch (error) {
                showAlert(`Failed to load post: ${error.message}`, 'error');
            }
        }

        async function handleEditPost(e) {
            e.preventDefault();
            
            const formData = new FormData();
            
            // Add text fields
            formData.append('title', elements.editTitle.value);
            formData.append('artist', elements.editArtist.value);
            formData.append('category', elements.editCategory.value);
            formData.append('tags', elements.editTags.value);
            formData.append('description', elements.editDescription.value);
            formData.append('status', elements.editStatus.value);
            
            if (elements.editStatus.value === 'scheduled') {
                formData.append('scheduled_at', elements.editScheduledAt.value);
            }
            
            // Add files if new ones are selected
            if (elements.editAudioInput.files[0]) {
                formData.append('audio', elements.editAudioInput.files[0]);
            }
            
            if (elements.editImageInput.files[0]) {
                formData.append('image', elements.editImageInput.files[0]);
            }
            
            // Show loading state
            elements.saveEditBtn.innerHTML = '<span class="loading"></span> Saving...';
            elements.saveEditBtn.disabled = true;
            
            try {
                // Find the post slug
                const post = state.posts.find(p => p.id === state.editPostId) ||
                             state.drafts.find(p => p.id === state.editPostId) ||
                             state.scheduled.find(p => p.id === state.editPostId);
                
                await apiRequest(`/posts/${post.slug}`, {
                    method: 'PUT',
                    body: formData
                });
                
                showAlert('Post updated successfully!', 'success');
                closeEditModal();
                
                // Refresh data
                if (state.currentPage === 'posts') loadPosts();
                if (state.currentPage === 'drafts') loadDrafts();
                
            } catch (error) {
                showAlert(`Failed to update post: ${error.message}`, 'error');
            } finally {
                elements.saveEditBtn.innerHTML = 'Save Changes';
                elements.saveEditBtn.disabled = false;
            }
        }

        function closeEditModal() {
            elements.editModal.style.display = 'none';
            elements.editPostForm.reset();
            state.editPostId = null;
        }

        // Delete functions
        async function confirmDeletePost(slug) {
            showConfirmationDialog(
                'Delete Post',
                'Are you sure you want to delete this post? This action cannot be undone.',
                () => deletePost(slug)
            );
        }

        async function deletePost(slug) {
            try {
                await apiRequest(`/posts/${slug}`, {
                    method: 'DELETE'
                });
                
                showAlert('Post deleted successfully!', 'success');
                
                // Refresh data
                if (state.currentPage === 'posts') loadPosts();
                if (state.currentPage === 'drafts') loadDrafts();
                
            } catch (error) {
                showAlert(`Failed to delete post: ${error.message}`, 'error');
            }
        }

        function confirmBulkDelete() {
            if (state.selectedPosts.size === 0) return;
            
            showConfirmationDialog(
                'Bulk Delete',
                `Are you sure you want to delete ${state.selectedPosts.size} selected posts? This action cannot be undone.`,
                () => bulkDeletePosts()
            );
        }

        async function bulkDeletePosts() {
            try {
                await apiRequest('/posts/bulk-delete', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ ids: Array.from(state.selectedPosts) })
                });
                
                showAlert(`Successfully deleted ${state.selectedPosts.size} posts!`, 'success');
                state.selectedPosts.clear();
                loadPosts();
                
            } catch (error) {
                showAlert(`Failed to delete posts: ${error.message}`, 'error');
            }
        }

        // Selection functions
        function toggleSelectAll() {
            const checkboxes = document.querySelectorAll('.post-checkbox');
            checkboxes.forEach(checkbox => {
                checkbox.checked = elements.selectAll.checked;
                togglePostSelection({ target: checkbox });
            });
        }

        function togglePostSelection(e) {
            const checkbox = e.target;
            const postId = checkbox.value;
            
            if (checkbox.checked) {
                state.selectedPosts.add(postId);
            } else {
                state.selectedPosts.delete(postId);
            }
            
            updateBulkDeleteButton();
        }

        function updateBulkDeleteButton() {
            elements.bulkDeleteBtn.style.display = state.selectedPosts.size > 0 ? 'inline-block' : 'none';
        }

        // File handling functions
        function handleAudioUpload() {
            const file = elements.audioInput.files[0];
            if (!file) return;
            
            elements.audioPreview.innerHTML = `
                <div class="preview-item">
                    <audio controls>
                        <source src="${URL.createObjectURL(file)}" type="${file.type}">
                    </audio>
                    <button class="remove-file" onclick="removeAudioFile()">&times;</button>
                </div>
            `;
        }

        function handleImageUpload() {
            const file = elements.imageInput.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = (e) => {
                elements.imagePreview.innerHTML = `
                    <div class="preview-item">
                        <img src="${e.target.result}" alt="Preview">
                        <button class="remove-file" onclick="removeImageFile()">&times;</button>
                    </div>
                `;
            };
            reader.readAsDataURL(file);
        }

        function handleEditAudioUpload() {
            const file = elements.editAudioInput.files[0];
            if (!file) return;
            
            elements.editAudioPreview.innerHTML = `
                <div class="preview-item">
                    <audio controls>
                        <source src="${URL.createObjectURL(file)}" type="${file.type}">
                    </audio>
                    <button class="remove-file" onclick="removeEditAudioFile()">&times;</button>
                </div>
            `;
        }

        function handleEditImageUpload() {
            const file = elements.editImageInput.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = (e) => {
                elements.editImagePreview.innerHTML = `
                    <div class="preview-item">
                        <img src="${e.target.result}" alt="Preview">
                        <button class="remove-file" onclick="removeEditImageFile()">&times;</button>
                    </div>
                `;
            };
            reader.readAsDataURL(file);
        }

        // File removal functions (exposed globally)
        window.removeAudioFile = function() {
            elements.audioPreview.innerHTML = '';
            elements.audioInput.value = '';
        };

        window.removeImageFile = function() {
            elements.imagePreview.innerHTML = '';
            elements.imageInput.value = '';
        };

        window.removeEditAudioFile = function() {
            elements.editAudioPreview.innerHTML = '';
            elements.editAudioInput.value = '';
        };

        window.removeEditImageFile = function() {
            elements.editImagePreview.innerHTML = '';
            elements.editImageInput.value = '';
        };

        window.viewArtistPosts = function(artist) {
            navigateTo('posts');
            // Filter posts by artist (this would require API support)
            showAlert(`Showing posts by ${artist}`, 'info');
        };

        function clearFilePreviews() {
            removeAudioFile();
            removeImageFile();
        }

        // UI helper functions
        function toggleScheduledField() {
            elements.scheduledField.style.display = 
                elements.statusSelect.value === 'scheduled' ? 'block' : 'none';
        }

        function toggleEditScheduledField() {
            elements.editScheduledField.style.display = 
                elements.editStatus.value === 'scheduled' ? 'block' : 'none';
        }

        function switchTab(tabId) {
            // Update tabs
            elements.tabs.forEach(tab => {
                tab.classList.toggle('active', tab.dataset.tab === tabId);
            });
            
            // Show selected tab content
            elements.tabContents.forEach(content => {
                content.classList.toggle('active', content.id === tabId);
            });
        }

        function showAlert(message, type = 'info') {
            const alert = document.createElement('div');
            alert.className = `alert alert-${type === 'error' ? 'error' : type === 'success' ? 'success' : 'warning'}`;
            alert.textContent = message;
            
            elements.alertContainer.appendChild(alert);
            alert.style.display = 'block';
            
            // Auto-remove after 5 seconds
            setTimeout(() => {
                alert.remove();
            }, 5000);
        }

        function showLoginAlert(message) {
            elements.loginAlert.textContent = message;
            elements.loginAlert.style.display = 'block';
        }

        function showConfirmationDialog(title, message, callback) {
            elements.confirmationTitle.textContent = title;
            elements.confirmationMessage.textContent = message;
            state.confirmationCallback = callback;
            elements.confirmationDialog.style.display = 'flex';
        }

        function closeConfirmationDialog() {
            elements.confirmationDialog.style.display = 'none';
            state.confirmationCallback = null;
        }

        function executeConfirmation() {
            if (state.confirmationCallback) {
                state.confirmationCallback();
            }
            closeConfirmationDialog();
        }

        // Initialize the application
        init();
    </script>
</body>
</html>
